# H.264 NALU 分析器

![Logo](./assets/nalu.svg)

H.264 NALU（Network Abstraction Layer Unit）分析器是一个基于浏览器的工具，用于分析和可视化 H.264 编码的视频流结构。该工具可以帮助开发人员、工程师和研究人员更好地理解 H.264 码流的组成和特性。

## H.264 NALU 简介

H.264 视频编码标准将编码后的视频数据组织成网络抽象层单元（NALU），这些单元构成了H.264码流的基本传输单位。每个NALU包含一个特定类型的数据，主要类型包括：

- **IDR帧（类型5）**：即时解码刷新帧，是一种特殊的I帧，视频播放可以从这里开始解码
- **非IDR帧（类型1）**：常规的非关键帧画面数据
- **SPS（类型7）**：序列参数集，包含整个视频序列的全局参数
- **PPS（类型8）**：图像参数集，包含编码和解码图像所需的参数
- **SEI（类型6）**：补充增强信息，提供额外的定时和显示信息
- **其他类型**：包括分隔符、序列结束、码流结束等控制信息

理解NALU结构对于视频流分析、传输优化和问题排查至关重要。本工具通过可视化方式帮助用户理解这些结构。

## 功能特点

- **NALU 解析**：自动解析并显示 H.264 文件中的所有 NALU 单元
- **详细信息展示**：显示每个 NALU 的类型、大小和详细属性
- **SPS/PPS 参数解析**：深入解析序列参数集(SPS)和图像参数集(PPS)的全部字段
- **十六进制查看器**：以十六进制格式查看每个 NALU 的原始数据
- **可视化序列视图**：直观展示整个视频流中 NALU 的分布情况
- **统计信息**：提供关键帧间隔等统计数据


## 在线使用

访问 [https://nalu.qer.im](https://nalu.qer.im) 体验在线版本

## 本地运行

1. 克隆仓库：
   ```bash
   git clone https://github.com/wbxl2000/h264-nalu-viewer.git
   cd h264-nalu-viewer
   ```

2. 安装依赖：
   ```bash
   npm install
   # 或者使用 pnpm
   pnpm install
   ```

3. 构建项目：
   ```bash
   npm run build
   # 或者使用 pnpm
   pnpm run build
   ```

4. 使用本地服务器打开 `index.html` 文件，例如：
   ```bash
   # 使用Python内置的HTTP服务器
   python -m http.server
   # 或者使用任何静态文件服务器
   ```

5. 在浏览器中访问 `http://localhost:8000`

## 使用方法

1. 打开网页后，将 H.264 格式文件（.h264 或 .264 扩展名）拖放到指定区域，或点击"选择文件"按钮
2. 也可以点击"加载示例"按钮加载内置的示例文件
3. 文件加载后，页面将自动解析并显示 NALU 序列
4. 点击任意 NALU 块可查看其详细信息
5. 对于 SPS 和 PPS 类型的 NALU，系统将显示完整的参数解析结果
6. 使用"上一个"和"下一个"按钮可以在不同的 NALU 之间导航

## 常见问题

### 支持哪些文件格式？
目前仅支持原始的 H.264 裸码流文件（.264 或 .h264 后缀），不支持MP4、MKV等容器格式。如需分析这些文件，请先提取其中的H.264视频流。

### 为什么某些H.264文件无法正确解析？
本工具期望H.264码流以标准的NALU格式存储，开头有0x000001或0x00000001起始码。某些特殊格式或受损的文件可能无法正确解析。

### 文件大小有限制吗？
由于所有处理都在浏览器中进行，过大的文件（>100MB）可能导致性能问题。建议分析较小的文件或片段。

### 我的数据会上传到服务器吗？
不会。所有处理都在您的浏览器中本地完成，没有任何数据会被上传到服务器。

## 技术实现

- 纯原生 JavaScript 实现，无需任何框架
- 优化 h264-sps-parser 解析库，并通过 Rollup 打包为 ESM 模块
- 完全在浏览器端解析，无需服务器支持
- 响应式设计，适配各种设备屏幕

## 相关链接

- [音频分析工具](https://pcm.qer.im) - 用于分析 PCM 音频数据的在线工具
- [H.264 标准规范](https://www.itu.int/rec/T-REC-H.264) - ITU-T H.264 视频编码标准

## 贡献

欢迎提交 Pull Request 或创建 Issue 来改进这个项目。

## 许可证

ISC

## 作者

[wbxl2000](https://github.com/wbxl2000)
